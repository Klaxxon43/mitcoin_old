# ton footstep 8 (ru)

by [@Revuza](https://t.me/revuza)

    
---

# –ü—Ä–∏—ë–º –ø–ª–∞—Ç–µ–∂–µ–π –≤ TON —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º telegram –±–æ—Ç–∞

---


## –ù–∞—á–∞–ª–æ

–£ –Ω–∞—Å –µ—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –±–ª–æ–∫—á–µ–π–Ω–æ–º –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ api –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ —Å–µ—Ç–∏. –ë–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–∏–º —Å–µ—Ä–≤–∏—Å–∞–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–æ–≥—É—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —à–∞–≥ —Å –∑–∞–ø—É—Å–∫–æ–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –Ω–æ–¥—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Å–≤–æ–µ–≥–æ api.

–í –¥–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç—å–µ –±—É–¥–µ—Ç –æ–ø–∏—Å–∞–Ω –ø—Ä–æ—Ü–µ—Å—Å —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–∞, —Å–ø–æ—Å–æ–±–Ω–æ–≥–æ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–ª–∞—Ç–µ–∂–∏ –≤ —Å–µ—Ç–∏ –¢–û–ù –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ç–æ—Ä–æ–Ω–Ω–µ–µ api –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º–æ–µ TON Center.

–ú—ã –±—É–¥–µ–º —Å–æ–∑–¥–∞–≤–∞—Ç—å –±–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—è –±–∏–±–ª–∏–æ—Ç–µ–∫—É –¥–ª—è python - aiogram. –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω Sqlite. –í –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–∏ –∫ —Å—Ç–∞—Ç—å–µ —è –ø–æ–∫–∞–∂—É, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å heroku postgres. –ë–æ—Ç –±—É–¥–µ—Ç –¥–µ–ø–ª–æ–∏—Ç—Å—è –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É heroku.

–Ø –∏—Å–ø–æ–ª—å–∑—É—é VS code.

## Telegram –±–æ—Ç

–î–ª—è –Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º –æ—Å–Ω–æ–≤—É –¥–ª—è –±–æ—Ç–∞.

–°–æ–∑–¥–∞–¥–∏–º —Ç—Ä–∏ —Ñ–∞–π–ª–∞:

`main.py`

`api.py`

`db.py`

–ù–∞—á–∞–ª–æ `main.py`:

```python
# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –º–æ–¥—É–ª–∏ –∏–∑ aiogram –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –Ω–∞—à–µ–≥–æ –±–æ—Ç–∞
import logging
from aiogram import Bot, Dispatcher, executor, types
# MemoryStorage –Ω—É–∂–µ–Ω –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
from aiogram.contrib.fsm_storage.memory import MemoryStorage
# FSM –¥–ª—è —Ä–∞–∑–±–∏—Ç–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–ø–ª–∞—Ç—ã –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —à–∞–≥–∏
from aiogram.dispatcher import FSMContext
from aiogram.dispatcher.filters.state import State, StatesGroup

import json

# –ê —Ç–∞–∫ –∂–µ –Ω–∞—à–∏ –º–æ–¥—É–ª–∏ –≤ –∫–æ—Ç–æ—Ä—ã—Ö –±—É–¥–µ—Ç –∫–æ–¥ 
# –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å API –∏ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
import db
import api
```

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø—Ä–µ–¥–ª–∞–≥–∞—é —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç–∞–∫–∏–µ –∫–∞–∫ `BOT_TOKEN` –∏–ª–∏ –≤–∞—à –∫–æ—à–µ–ª—ë–∫ –¥–ª—è –ø—Ä–∏—ë–º–∞ –ø–ª–∞—Ç–µ–∂–µ–π –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ `config.json`:

```json
{
    "BOT_TOKEN": "Your bot token",
    "MAINNET_API_TOKEN": "Your mainnet api token",
    "TESTNET_API_TOKEN": "Your testnet api token",
    "MAINNET_WALLET": "Your mainnet wallet",
    "TESTNET_WALLET": "Your testnet wallet",
    "WORK_MODE": "testnet"
}
```

–í –∫–ª—é—á–µ `WORK_MODE` –º—ã –±—É–¥–µ–º –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ - –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –∏–ª–∏ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ç–∏: `testnet` –∏–ª–∏ `mainnet` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

Api —Ç–æ–∫–µ–Ω –¥–ª—è `*_API_TOKEN` –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –≤ –±–æ—Ç–µ [toncenter](https://toncenter.com/):

–¥–ª—è mainnet - [@tonapibot](https://t.me/tonapibot)

–¥–ª—è testnet - [@tontestnetapibot](https://t.me/tontestnetapibot)

–î–∞–ª–µ–µ, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞, –º—ã —á–∏—Ç–∞–µ–º –µ–≥–æ –∏–∑ —Ñ–∞–π–ª–∞ `config.json`:

```python
with open('config.json', 'r') as f:
    config_json = json.load(f)
    BOT_TOKEN = config_json['BOT_TOKEN']
		# –Ω–∞–º –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å, –∫–∞–∫–æ–π –∫–æ—à–µ–ª—ë–∫ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –ø–ª–∞—Ç–µ–∂—ã
    MAINNET_WALLET = config_json['MAINNET_WALLET']
    TESTNET_WALLET = config_json['TESTNET_WALLET']
    WORK_MODE = config_json['WORK_MODE']

if WORK_MODE == "mainnet":
    WALLET = MAINNET_WALLET
else:
		# –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –±–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å–µ—Ç–∏
    WALLET = TESTNET_WALLET
```

–î–∞–ª–µ–µ –º—ã –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É –±–æ—Ç–∞:

```python
logging.basicConfig(level=logging.INFO)
bot = Bot(token=BOT_TOKEN, parse_mode=types.ParseMode.HTML)
dp = Dispatcher(bot, storage=MemoryStorage())

class DataInput (StatesGroup):
    firstState = State()
    secondState = State()
    WalletState = State()
    PayState = State()
```

–í –∫–æ–Ω—Ü–µ –Ω–µ –∑–∞–±—ã–≤–∞–µ–º –ø—Ä–æ:

```python
if __name__ == '__main__':
    executor.start_polling(dp, skip_updates=True)
```

–≠—Ç–æ—Ç –±–ª–æ–∫ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ —Ñ–∞–π–ª–∞, –ø–æ—Å–ª–µ –≤—Å–µ—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

–ù–µ –±—É–¥—É —É—Ö–æ–¥–∏—Ç—å –µ—â—ë –≥–ª—É–±–∂–µ. –ó–∞ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç—è–º–∏ –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ –ø—Ä–µ–¥–ª–∞–≥–∞—é –∑–∞–≥–ª—è–Ω—É—Ç—å –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é Aiogram](https://docs.aiogram.dev/en/latest/).

### –ü–æ–ª–Ω—ã–π –∫–æ–¥ `main.py`.

```python
import logging
from aiogram import Bot, Dispatcher, executor, types
from aiogram.contrib.fsm_storage.memory import MemoryStorage
from aiogram.dispatcher import FSMContext
from aiogram.dispatcher.filters.state import State, StatesGroup

import json

import db
import api

with open('config.json', 'r') as f:
    config_json = json.load(f)
    BOT_TOKEN = config_json['BOT_TOKEN']
    MAINNET_WALLET = config_json['MAINNET_WALLET']
    TESTNET_WALLET = config_json['TESTNET_WALLET']
    WORK_MODE = config_json['WORK_MODE']

if WORK_MODE == "mainnet":
    WALLET = MAINNET_WALLET
else:
    WALLET = TESTNET_WALLET

# Configure logging
logging.basicConfig(level=logging.INFO)
bot = Bot(token=BOT_TOKEN, parse_mode=types.ParseMode.HTML)
# storage=MemoryStorage() needed for FSM
dp = Dispatcher(bot, storage=MemoryStorage())

class DataInput (StatesGroup):
    firstState = State()
    secondState = State()
    WalletState = State()
    PayState = State()

# /start command handler
@dp.message_handler(commands=['start'], state='*')
async def cmd_start(message: types.Message):
    await message.answer(f"WORKMODE: {WORK_MODE}")
    # check if user is in database. if not, add him
    isOld = db.check_user(
        message.from_user.id, message.from_user.username, message.from_user.first_name)
    # if user already in database, we can address him differently
    if isOld == False:
        await message.answer(f"You are new here, {message.from_user.first_name}!")
        await message.answer(f"to buy air send /buy")
    else:
        await message.answer(f"Welcome once again, {message.from_user.first_name}!")
        await message.answer(f"to buy more air send /buy")
    await DataInput.firstState.set()

@dp.message_handler(commands=['cancel'], state="*")
async def cmd_cancel(message: types.Message):
    await message.answer("Canceled")
    await message.answer("/start to restart")
    await DataInput.firstState.set()

@dp.message_handler(commands=['buy'], state=DataInput.firstState)
async def cmd_buy(message: types.Message):
    # reply keyboard with air types
    keyboard = types.ReplyKeyboardMarkup(
        resize_keyboard=True, one_time_keyboard=True)
    keyboard.add(types.KeyboardButton('Just pure üå´'))
    keyboard.add(types.KeyboardButton('Spring forest üå≤'))
    keyboard.add(types.KeyboardButton('Sea breeze üåä'))
    keyboard.add(types.KeyboardButton('Fresh asphalt üõ£'))
    await message.answer(f"Choose your air: (or /cancel)", reply_markup=keyboard)
    await DataInput.secondState.set()

@dp.message_handler(commands=['me'], state="*")
async def cmd_me(message: types.Message):
    await message.answer(f"Your transactions")
    # db.get_user_payments returns list of transactions for user
    transactions = db.get_user_payments(message.from_user.id)
    if transactions == False:
        await message.answer(f"You have no transactions")
    else:
        for transaction in transactions:
            # we need to remember that blockchain stores value in nanotons. 1 toncoin = 1000000000 in blockchain
            await message.answer(f"{int(transaction['value'])/1000000000} - {transaction['comment']}")

# handle air type
@dp.message_handler(state=DataInput.secondState)
async def air_type(message: types.Message, state: FSMContext):
    if message.text == "Just pure üå´":
        await state.update_data(air_type="Just pure üå´")
        await DataInput.WalletState.set()
    elif message.text == "Fresh asphalt üõ£":
        await state.update_data(air_type="Fresh asphalt üõ£")
        await DataInput.WalletState.set()
    elif message.text == "Spring forest üå≤":
        await state.update_data(air_type="Spring forest üå≤")
        await DataInput.WalletState.set()
    elif message.text == "Sea breeze üåä":
        await state.update_data(air_type="Sea breeze üåä")
        await DataInput.WalletState.set()
    else:
        await message.answer("Wrong air type")
        await DataInput.secondState.set()
        return
    await message.answer(f"Send your wallet address")

# handle wallet address

@dp.message_handler(state=DataInput.WalletState)
async def user_wallet(message: types.Message, state: FSMContext):
    if len(message.text) == 48:
        res = api.detect_address(message.text)
        if res == False:
            await message.answer("Wrong wallet address")
            await DataInput.WalletState.set()
            return
        else:
            user_data = await state.get_data()
            air_type = user_data['air_type']
            # inline button "check transaction"
            keyboard2 = types.InlineKeyboardMarkup(row_width=1)
            keyboard2.add(types.InlineKeyboardButton(
                text="Check transaction", callback_data="check"))
            keyboard1 = types.InlineKeyboardMarkup(row_width=1)
            keyboard1.add(types.InlineKeyboardButton(
                text="Ton Wallet", url=f"ton://transfer/{WALLET}?amount=1000000000&text={air_type}"))
            keyboard1.add(types.InlineKeyboardButton(
                text="Tonkeeper", url=f"https://app.tonkeeper.com/transfer/{WALLET}?amount=1000000000&text={air_type}"))
            keyboard1.add(types.InlineKeyboardButton(
                text="Tonhub", url=f"https://tonhub.com/transfer/{WALLET}?amount=1000000000&text={air_type}"))
            await message.answer(f"You choose {air_type}")
            await message.answer(f"Send <code>1</code> toncoin to address \n<code>{WALLET}</code> \nwith comment \n<code>{air_type}</code> \nfrom your wallet ({message.text}) \nton://transfer/{WALLET}?amount=1000000000&text={air_type}", reply_markup=keyboard1)
            await message.answer(f"Click the button after payment", reply_markup=keyboard2)
            await DataInput.PayState.set()
            await state.update_data(wallet=res)
            await state.update_data(value_nano="1000000000")
    else:
        await message.answer("Wrong wallet address")
        await DataInput.WalletState.set()

@dp.callback_query_handler(lambda call: call.data == "check", state=DataInput.PayState)
async def check_transaction(call: types.CallbackQuery, state: FSMContext):
    # send notification
    user_data = await state.get_data()
    source = user_data['wallet']
    value = user_data['value_nano']
    comment = user_data['air_type']
    result = api.find_transaction(source, value, comment)
    if result == False:
        await call.answer("Wait a bit, try again in 10 seconds. You can also check the status of the transaction through the explorer (ton.sh/)", show_alert=True)
    else:
        db.v_wallet(call.from_user.id, source)
        await call.message.edit_text("Transaction is confirmed \n/start to restart")
        await state.finish()
        await DataInput.firstState.set()

if __name__ == '__main__':
    executor.start_polling(dp, skip_updates=True)
```

*–ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –ø–æ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –º–æ–º–µ–Ω—Ç–∞–º —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –∫ –∫–æ–¥—É.*

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –°–æ–∑–¥–∞—ë–º –ë–î

–í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Sqlite.

–£ –Ω–∞—Å –µ—Å—Ç—å 2 —Ç–∞–±–ª–∏—Ü—ã:

transactions

```sql
CREATE TABLE transactions (
    source  VARCHAR (48) NOT NULL,
    hash    VARCHAR (50) UNIQUE
                         NOT NULL,
    value   INTEGER      NOT NULL,
    comment VARCHAR (50) 
);
```

![Untitled](ton%20footstep%208%20(ru)%2089efbd0580e045958611562e2623ab1e/Untitled.png)

users

```sql
CREATE TABLE users (
    id         INTEGER       UNIQUE
                             NOT NULL,
    username   VARCHAR (33),
    first_name VARCHAR (300),
    wallet     VARCHAR (50)  DEFAULT none
);
```

![Untitled](ton%20footstep%208%20(ru)%2089efbd0580e045958611562e2623ab1e/Untitled%201.png)

–í —Ç–∞–±–ª–∏—Ü–µ `users` –º—ã —Ö—Ä–∞–Ω–∏–º ‚Ä¶ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ò—Ö telegram id, @username, first name –∏ –∫–æ—à–µ–ª—ë–∫. –ö–æ—à–µ–ª—ë–∫ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –ø–µ—Ä–≤–æ–π —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç–µ.

–í —Ç–∞–±–ª–∏—Ü–µ `transactions` —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

### –†–∞–±–æ—Ç–∞–µ–º —Å –ë–î

–û—Ç–∫—Ä—ã–≤–∞–µ–º `db.py`.

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–¥–µ–ª–∞–ª —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –∏ –Ω–∞–∂–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫—É –¥–ª—è –µ—ë –ø—Ä–æ–≤–µ—Ä–∫–∏. –ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã –æ–¥–Ω—É –∏ —Ç—É–∂–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, –æ–Ω –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –¥–≤–∞–∂–¥—ã?

–í —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç body_hash, –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –º—ã –º–æ–∂–µ–º –ª–µ–≥–∫–æ –ø–æ–Ω—è—Ç—å - –µ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤ –±–¥ –∏–ª–∏ –Ω–µ—Ç.

–í –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –º—ã –¥–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –º—ã ‚Äú—É–≤–µ—Ä–µ–Ω—ã‚Äù. –ê —Ñ—É–Ω–∫—Ü–∏—è `check_transaction` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –µ—Å—Ç—å –ª–∏ –Ω–∞–π–¥–µ–Ω–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –≤ –±–∞–∑–µ –∏–ª–∏ –Ω–µ—Ç.

```python
def add_v_transaction(source, hash, value, comment):
    cur.execute("INSERT INTO transactions (source, hash, value, comment) VALUES (?, ?, ?, ?)",
                (source, hash, value, comment))
    locCon.commit()
```

```python
def check_transaction(hash):
    cur.execute(f"SELECT hash FROM transactions WHERE hash = '{hash}'")
    result = cur.fetchone()
    if result:
        return True
    return False
```

`get_user_payments` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–∫—É–ø–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

```python
def get_user_payments(user_id):
    wallet = get_user_wallet(user_id)

    if wallet == "none":
        return "You have no wallet"
    else:

        cur.execute(f"SELECT * FROM transactions WHERE source = '{wallet}'")
        result = cur.fetchall()
        tdict = {}
        tlist = []
        try:
            for transaction in result:
                tdict = {
                    "value": transaction[2],
                    "comment": transaction[3],
                }
                tlist.append(tdict)
            return tlist

        except:

            return False
```

## API

### –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã

–ü–æ —Å—É—Ç–∏, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–≤—ë–ª –Ω–∞–º –Ω—É–∂–Ω—É—é —Å—É–º–º—É? –ù–∞–º –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –≤—Ö–æ–¥—è—â–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã –Ω–∞ –Ω–∞—à –∫–æ—à–µ–ª—ë–∫ –∏ —Å—Ä–µ–¥–∏ –Ω–∏—Ö –Ω–∞–π—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å –Ω—É–∂–Ω–æ–≥–æ –∞–¥—Ä–µ—Å–∞, —Å –Ω—É–∂–Ω–æ–π —Å—É–º–º–æ–π (–∏ –≤–æ–∑–º–æ–∂–Ω–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º). –î–ª—è –≤—Å–µ–≥–æ —ç—Ç–æ–≥–æ —É toncenter –µ—Å—Ç—å –º–µ—Ç–æ–¥ `getTransactions`:

![Untitled](ton%20footstep%208%20(ru)%2089efbd0580e045958611562e2623ab1e/Untitled%202.png)

–ü—Ä–∏–º–µ–Ω–∏–≤ –µ–≥–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –º—ã –ø–æ–ª—É—á–∏–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –û–¥–Ω–∞–∫–æ –º—ã –º–æ–∂–µ–º —Ç–∞–∫ –∂–µ —É–∫–∞–∑–∞—Ç—å, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ. –û–¥–Ω–∞–∫–æ, —á–µ–º –±–æ–ª—å—à–µ –≤—ã –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç–µ, —Ç–µ–º –¥–æ–ª—å—à–µ –±—É–¥–µ—Ç –æ—Ç–≤–µ—Ç. –î–∞ –∏, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –Ω–µ –Ω—É–∂–Ω–æ –≤–∞–º —Å—Ç–æ–ª—å–∫–æ. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, —Ç–æ —É –∫–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –µ—Å—Ç—å `lt` –∏ `hash` . –í—ã –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, 30 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –µ—Å–ª–∏ —Å—Ä–µ–¥–∏ –Ω–∏—Ö –Ω–µ –Ω–∞—à–ª–∞—Å—å –Ω—É–∂–Ω–∞—è, —Ç–æ–≥–¥–∞ –≤–∑—è—Ç—å `lt` –∏ `hash` –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏ –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö –∫ –∑–∞–ø—Ä–æ—Å—É - –ø–æ–ª—É—á–∏–≤ —Å–ª–µ–¥—É—é—â–∏–µ 30 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ.

–î–ª—è –ø—Ä–∏–º–µ—Ä–∞ - –µ—Å—Ç—å –∫–æ—à–µ–ª—ë–∫ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å–µ—Ç–∏ `EQAVKMzqtrvNB2SkcBONOijadqFZ1gMdjmzh1Y3HB1p_zai5`, —É –Ω–µ–≥–æ –≤—Å–µ–≥–æ 4 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–≤ –∑–∞–ø—Ä–æ—Å `https://testnet.toncenter.com/api/v2/getTransactions?address=EQAVKMzqtrvNB2SkcBONOijadqFZ1gMdjmzh1Y3HB1p_zai5&limit=2&to_lt=0&archival=true` –º—ã –ø–æ–ª—É—á–∏–º —Å–ª–µ–¥—É—é—â–∏–π –æ—Ç–≤–µ—Ç:

```json
{
  "ok": true,
  "result": [
    {
      "@type": "raw.transaction",
      "utime": 1658130319,
      "data": "te6cckECBQEAAR4AA7FxUozOq2u80HZKRwE406KNp2oVnWAx2ObOHVjccHWn/NAAABxMCR0wOHEhCqfuVgP9z981Ltb+JWyDaTHSn+Q0gYXot3RAQjGQAAAcRtuBuDYtUPjwAAAkKAECAwEBoAQAgnL4IEWB5LE/vWXLudaYwd8il06Rzrek5pd9TCOm8FDCRlEx0oZZ4VOvcucIihMYSiqChFZPUftTeQSXkXfpjbrGABEMSEkO5rKAASAA10gBZoEkggIfC1iCuX4nc2G4wq+hNHOlehBP1bZBAz4M8NEABUozOq2u80HZKRwE406KNp2oVnWAx2ObOHVjccHWn/NQ7msoAAYUWGAAAAOJgSOmBMWqHx4AAAAAKbKwkDE5MrK9MpB4T8ZFQBMtbAk=",
      "transaction_id": {
        "@type": "internal.transactionId",
        "lt": "1944556000003",
        "hash": "swpaG6pTBXwYI2024NAisIFp59Fw3k1DRQ5fa5SuKAE="
      },
      "fee": "33",
      "storage_fee": "33",
      "other_fee": "0",
      "in_msg": {
        "@type": "raw.message",
        "source": "EQCzQJJBAQ-FrEFcvxO5sNxhV9CaOdK9CCfq2yCBnwZ4aJ9R",
        "destination": "EQAVKMzqtrvNB2SkcBONOijadqFZ1gMdjmzh1Y3HB1p_zai5",
        "value": "1000000000",
        "fwd_fee": "666672",
        "ihr_fee": "0",
        "created_lt": "1944556000002",
        "body_hash": "kBfGYBTkBaooeZ+NTVR0EiVGSybxQdb/ifXCRX5O7e0=",
        "msg_data": {
          "@type": "msg.dataText",
          "text": "U2VhIGJyZWV6ZSDwn4yK"
        },
        "message": "Sea breeze üåä"
      },
      "out_msgs": []
    },
    {
      "@type": "raw.transaction",
      "utime": 1658126823,
      "data": "te6cckECBQEAASMAA7NxUozOq2u80HZKRwE406KNp2oVnWAx2ObOHVjccHWn/NAAABxG24G4OTlT0DAhE0aELXSEcncwE49P/9vECBbl31+UWLCvVJqgAAAa2t3liDYtUB5wAABBI2gBAgMBAaAEAIJyKqjqNU0guBAa3/ENp+bnQLlnXhkASZW2OWeFM5DakO/4IEWB5LE/vWXLudaYwd8il06Rzrek5pd9TCOm8FDCRgATDIJGyQ7msoABIADdSAFmgSSCAh8LWIK5fidzYbjCr6E0c6V6EE/VtkEDPgzw0QAFSjM6ra7zQdkpHATjToo2nahWdYDHY5s4dWNxwdaf81DuaygABhRYYAAAA4jbcDcExaoDzgAAAAApuDk0tzOQMze5Mrm6EHhPxllAGLZ+6g==",
      "transaction_id": {
        "@type": "internal.transactionId",
        "lt": "1943166000003",
        "hash": "hxIQqn7lYD/c/fNS7W/iVsg2kx0p/kNIGF6Ld0QEIxk="
      },
      "fee": "2331",
      "storage_fee": "2331",
      "other_fee": "0",
      "in_msg": {
        "@type": "raw.message",
        "source": "EQCzQJJBAQ-FrEFcvxO5sNxhV9CaOdK9CCfq2yCBnwZ4aJ9R",
        "destination": "EQAVKMzqtrvNB2SkcBONOijadqFZ1gMdjmzh1Y3HB1p_zai5",
        "value": "1000000000",
        "fwd_fee": "666672",
        "ihr_fee": "0",
        "created_lt": "1943166000002",
        "body_hash": "7iirXn1RtliLnBUGC5umIQ6KTw1qmPk+wwJ5ibh9Pf0=",
        "msg_data": {
          "@type": "msg.dataText",
          "text": "U3ByaW5nIGZvcmVzdCDwn4yy"
        },
        "message": "Spring forest üå≤"
      },
      "out_msgs": []
    }
  ]
}
```

–ú—ã –ø–æ–ª—É—á–∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –¥–≤–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —ç—Ç–æ–≥–æ –∞–¥—Ä–µ—Å–∞. –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫ –∑–∞–ø—Ä–æ—Å—É `lt` –∏ `hash`: –º—ã —Å–Ω–æ–≤–∞ –ø–æ–ª—É—á–∏–º –¥–≤–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –æ–¥–Ω–∞–∫–æ –≤—Ç–æ—Ä–∞—è, —Å—Ç–∞–Ω–µ—Ç —Å–ª–µ–¥—É—é—â–µ–π –ø–æ —Å—á—ë—Ç—É. –¢–æ –µ—Å—Ç—å - –º—ã –ø–æ–ª—É—á–∏–º –≤—Ç–æ—Ä—É—é –∏ —Ç—Ä–µ—Ç—å—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —ç—Ç–æ–≥–æ –∞–¥—Ä–µ—Å–∞:

```json
{
  "ok": true,
  "result": [
    {
      "@type": "raw.transaction",
      "utime": 1658126823,
      "data": "te6cckECBQEAASMAA7NxUozOq2u80HZKRwE406KNp2oVnWAx2ObOHVjccHWn/NAAABxG24G4OTlT0DAhE0aELXSEcncwE49P/9vECBbl31+UWLCvVJqgAAAa2t3liDYtUB5wAABBI2gBAgMBAaAEAIJyKqjqNU0guBAa3/ENp+bnQLlnXhkASZW2OWeFM5DakO/4IEWB5LE/vWXLudaYwd8il06Rzrek5pd9TCOm8FDCRgATDIJGyQ7msoABIADdSAFmgSSCAh8LWIK5fidzYbjCr6E0c6V6EE/VtkEDPgzw0QAFSjM6ra7zQdkpHATjToo2nahWdYDHY5s4dWNxwdaf81DuaygABhRYYAAAA4jbcDcExaoDzgAAAAApuDk0tzOQMze5Mrm6EHhPxllAGLZ+6g==",
      "transaction_id": {
        "@type": "internal.transactionId",
        "lt": "1943166000003",
        "hash": "hxIQqn7lYD/c/fNS7W/iVsg2kx0p/kNIGF6Ld0QEIxk="
      },
      "fee": "2331",
      "storage_fee": "2331",
      "other_fee": "0",
      "in_msg": {
        "@type": "raw.message",
        "source": "EQCzQJJBAQ-FrEFcvxO5sNxhV9CaOdK9CCfq2yCBnwZ4aJ9R",
        "destination": "EQAVKMzqtrvNB2SkcBONOijadqFZ1gMdjmzh1Y3HB1p_zai5",
        "value": "1000000000",
        "fwd_fee": "666672",
        "ihr_fee": "0",
        "created_lt": "1943166000002",
        "body_hash": "7iirXn1RtliLnBUGC5umIQ6KTw1qmPk+wwJ5ibh9Pf0=",
        "msg_data": {
          "@type": "msg.dataText",
          "text": "U3ByaW5nIGZvcmVzdCDwn4yy"
        },
        "message": "Spring forest üå≤"
      },
      "out_msgs": []
    },
    {
      "@type": "raw.transaction",
      "utime": 1657873517,
      "data": "te6cckECBQEAARUAA7FxUozOq2u80HZKRwE406KNp2oVnWAx2ObOHVjccHWn/NAAABra3eWINHKamCzNyhJYhx3LFjT1LoOSb8t8/BKZD64tdlEozSkwAAAa2sQlvDYtEkbQAAAgKAECAwEBoAQAgnIWNBaoz9t25kiF2dzOj2M7gKcODZM65K9V66Bee1OTpSqo6jVNILgQGt/xDafm50C5Z14ZAEmVtjlnhTOQ2pDvABEMQEkO5rKAASAAxUgBZoEkggIfC1iCuX4nc2G4wq+hNHOlehBP1bZBAz4M8NEABUozOq2u80HZKRwE406KNp2oVnWAx2ObOHVjccHWn/NQ7msoAAYUWGAAAANbW7yxBMWiSNoAAAAAKbKxt7cyQB5Hn/Q=",
      "transaction_id": {
        "@type": "internal.transactionId",
        "lt": "1845458000003",
        "hash": "k5U9AwIRNGhC10hHJ3MBOPT//bxAgW5d9flFiwr1Sao="
      },
      "fee": "1",
      "storage_fee": "1",
      "other_fee": "0",
      "in_msg": {
        "@type": "raw.message",
        "source": "EQCzQJJBAQ-FrEFcvxO5sNxhV9CaOdK9CCfq2yCBnwZ4aJ9R",
        "destination": "EQAVKMzqtrvNB2SkcBONOijadqFZ1gMdjmzh1Y3HB1p_zai5",
        "value": "1000000000",
        "fwd_fee": "666672",
        "ihr_fee": "0",
        "created_lt": "1845458000002",
        "body_hash": "XpTXquHXP64qN6ihHe7Tokkpy88tiL+5DeqIrvrNCyo=",
        "msg_data": {
          "@type": "msg.dataText",
          "text": "U2Vjb25k"
        },
        "message": "Second"
      },
      "out_msgs": []
    }
  ]
}
```

–ó–∞–ø—Ä–æ—Å –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤–æ—Ç —Ç–∞–∫ - `https://testnet.toncenter.com/api/v2/getTransactions?address=EQAVKMzqtrvNB2SkcBONOijadqFZ1gMdjmzh1Y3HB1p_zai5&limit=2&lt=1943166000003&hash=hxIQqn7lYD%2Fc%2FfNS7W%2FiVsg2kx0p%2FkNIGF6Ld0QEIxk%3D&to_lt=0&archival=true` 

–¢–∞–∫ –∂–µ –Ω–∞–º –ø—Ä–∏–≥–æ–¥–∏—Ç—Å—è –º–µ—Ç–æ–¥ `detectAddress`.

–ù–µ —É–≤–µ—Ä–µ–Ω –Ω–∞—Å—á—ë—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ç–∏, –Ω–æ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π —Å–µ—Ç–∏, –∞–¥—Ä–µ—Å –º–æ–µ–≥–æ –∫–æ—à–µ–ª—å–∫–∞ –≤ tonkeeper —Ç–∞–∫–æ–π:
`kQCzQJJBAQ-FrEFcvxO5sNxhV9CaOdK9CCfq2yCBnwZ4aCTb`, –∞ –∫–æ–≥–¥–∞ —è —Å–º–æ—Ç—Ä—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ —ç–∫—Å–ø–ª–æ—Ä–µ—Ä–µ —Ç–æ –≤–º–µ—Å—Ç–æ –º–æ–µ–≥–æ –∞–¥—Ä–µ—Å–∞ —Ç–∞–º 
`EQCzQJJBAQ-FrEFcvxO5sNxhV9CaOdK9CCfq2yCBnwZ4aJ9R`.
–î–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–º ‚Äú–Ω—É–∂–Ω—ã–π‚Äù –∞–¥—Ä–µ—Å:

```json
{
  "ok": true,
  "result": {
    "raw_form": "0:b3409241010f85ac415cbf13b9b0dc6157d09a39d2bd0827eadb20819f067868",
    "bounceable": {
      "b64": "EQCzQJJBAQ+FrEFcvxO5sNxhV9CaOdK9CCfq2yCBnwZ4aJ9R",
      "b64url": "EQCzQJJBAQ-FrEFcvxO5sNxhV9CaOdK9CCfq2yCBnwZ4aJ9R"
    },
    "non_bounceable": {
      "b64": "UQCzQJJBAQ+FrEFcvxO5sNxhV9CaOdK9CCfq2yCBnwZ4aMKU",
      "b64url": "UQCzQJJBAQ-FrEFcvxO5sNxhV9CaOdK9CCfq2yCBnwZ4aMKU"
    },
    "given_type": "friendly_bounceable",
    "test_only": true
  }
}
```

–ù–∞–º –Ω—É–∂–µ–Ω `b64url`.

–¢–∞–∫–∂–µ, —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∞–¥—Ä–µ—Å–∞ –ø—Ä–∏—Å–ª–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.

–ü–æ –±–æ–ª—å—à–æ–º—É —Å—á—ë—Ç—É, —ç—Ç–æ –≤—Å—ë, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ.

### –ó–∞–ø—Ä–æ—Å—ã –∫ API, –∏ —á—Ç–æ —Å –Ω–∏–º–∏ –¥–∞–ª—å—à–µ –¥–µ–ª–∞—Ç—å

–í–µ—Ä–Ω—ë–º—Å—è –≤ IDE. –æ—Ç–∫—Ä–æ–µ–º —Ñ–∞–π–ª `api.py`.

```python
import requests
import json
# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –Ω–∞—à –º–æ–¥—É–ª—å db, —Ç–∞–∫ –∫–∞–∫ –æ—Ç—Å—é–¥–∞ –±—É–¥–µ—Ç —É–¥–æ–±–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å
# —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
import db

# –≠—Ç–æ –Ω–∞—á–∞–ª–æ –Ω–∞—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
MAINNET_API_BASE = "https://toncenter.com/api/v2/"
TESTNET_API_BASE = "https://testnet.toncenter.com/api/v2/"

# –£–∑–Ω–∞—ë–º –≤ –∫–∞–∫–æ–π —Å–µ—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ–º
with open('config.json', 'r') as f:
    config_json = json.load(f)
    MAINNET_API_TOKEN = config_json['MAINNET_API_TOKEN']
    TESTNET_API_TOKEN = config_json['TESTNET_API_TOKEN']
    MAINNET_WALLET = config_json['MAINNET_WALLET']
    TESTNET_WALLET = config_json['TESTNET_WALLET']
    WORK_MODE = config_json['WORK_MODE']

if WORK_MODE == "mainnet":
    API_BASE = MAINNET_API_BASE
    API_TOKEN = MAINNET_API_TOKEN
    WALLET = MAINNET_WALLET
else:
    API_BASE = TESTNET_API_BASE
    API_TOKEN = TESTNET_API_TOKEN
    WALLET = TESTNET_WALLET
```

–ù–∞—à–∞ –ø–µ—Ä–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∑–∞–ø—Ä–æ—Å–æ–º `detectAddress`:

```python
def detect_address(address):
    url = f"{API_BASE}detectAddress?address={address}&api_key={API_TOKEN}"
    r = requests.get(url)
    response = json.loads(r.text)
    try:
        return response['result']['bounceable']['b64url']
    except:
        return False
```

–ù–∞ –≤—Ö–æ–¥–µ —É –Ω–∞—Å - –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–π –∞–¥—Ä–µ—Å, –∞ –Ω–∞ –≤—ã—Ö–æ–¥–µ, –ª–∏–±–æ ‚Äú–Ω—É–∂–Ω—ã–π‚Äù –Ω–∞–º –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã ‚Äú–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π‚Äù –∞–¥—Ä–µ—Å, –ª–∏–±–æ –õ–æ–∂—å.

–í—ã –º–æ–∂–µ—Ç–µ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –≤ –∫–æ–Ω—Ü–µ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ—è–≤–∏–ª—Å—è API –∫–ª—é—á. –û–Ω –Ω—É–∂–µ–Ω –¥–ª—è —Å–Ω—è—Ç–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API. –ë–µ–∑ –Ω–µ–≥–æ –º—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã –æ–¥–Ω–∏–º –∑–∞–ø—Ä–æ—Å–æ–º –≤ —Å–µ–∫—É–Ω–¥—É.

–°–ª–µ–¥—É—é—â–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è `getTransactions`:

```python
def get_address_transactions():
    url = f"{API_BASE}getTransactions?address={WALLET}&limit=30&archival=true&api_key={API_TOKEN}"
    r = requests.get(url)
    response = json.loads(r.text)
    return response['result']
```

–î–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è –Ω–∞—à–µ–≥–æ `WALLET`.

–ó–¥–µ—Å—å –º–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å `archival=true`, –æ–Ω –Ω—É–∂–µ–Ω –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –º—ã –±—Ä–∞–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Ç–æ–ª—å–∫–æ —Å —É–∑–ª–∞ —Å –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π –±–ª–æ–∫—á–µ–π–Ω–∞. 

–ù–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π - [{0},{1},{‚Ä¶},{29}]. –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π, –∫–æ—Ä–æ—á–µ –≥–æ–≤–æ—Ä—è.

–ò, –Ω–∞–∫–æ–Ω–µ—Ü, –ø–æ—Å–ª–µ–¥–Ω—è—è —Ñ—É–Ω–∫—Ü–∏—è:

```python
def find_transaction(user_wallet, value, comment):
		# –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
    transactions = get_address_transactions()
    for transaction in transactions:
				# –í—ã–±–∏—Ä–∞–µ–º –≤—Ö–æ–¥—è—â–µ–µ "—Å–æ–æ–±—â–µ–Ω–∏–µ" - —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
        msg = transaction['in_msg']
        if msg['source'] == user_wallet and msg['value'] == value and msg['message'] == comment:
						# –ü—Ä–∏ –ø–æ–ª–Ω–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
						# –º—ã –Ω–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–ª–∏ —Ä–∞–Ω–µ–µ
            t = db.check_transaction(msg['body_hash'])
            if t == False:
								# –ï—Å–ª–∏ –Ω–µ—Ç - –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ —Ç–∞–±–ª–∏—Ü—É –∫ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º
								# –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º True
                db.add_v_transaction(
                    msg['source'], msg['body_hash'], msg['value'], msg['message'])
                print("find transaction")
                print(
                    f"transaction from: {msg['source']} \nValue: {msg['value']} \nComment: {msg['message']}")
                return True
						# –ï—Å–ª–∏ –¥–∞–Ω–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É–∂–µ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞ -
						# –ø—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ, –º–æ–∂–µ—Ç –Ω–∞–π–¥—ë–º –Ω—É–∂–Ω—É—é
            else:
                pass
		# –ï—Å–ª–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 30 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –Ω–µ—Ç –Ω—É–∂–Ω–æ–π - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º False
		# –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç—å –∫–æ–¥, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ 29 —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
		# –û–¥–Ω–∞–∫–æ –≤ —Ä–∞–º–∫–∞—Ö –ü—Ä–∏–º–µ—Ä–∞ —ç—Ç–æ –±—É–¥–µ—Ç –ª–∏—à–Ω–∏–º.
    return False
```

–ù–∞ –≤—Ö–æ–¥–µ ‚Äú–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π‚Äù –∞–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞, —Å—É–º–º–∞ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π. –ù–∞ –≤—ã—Ö–æ–¥–µ –ò—Å—Ç–∏–Ω–∞ –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ –Ω—É–∂–Ω–∞—è –≤—Ö–æ–¥—è—â–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –∏ –õ–æ–∂—å –µ—Å–ª–∏ –Ω–µ—Ç.
